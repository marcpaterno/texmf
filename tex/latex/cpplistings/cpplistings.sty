%======================================================================
%
%  cpplistings - provide for listings and inline snippets of C++ code
%
%======================================================================
%
% To produce an inline code snippet:
%   \cppcode[option]{code}
% Uses \cppfgcolor and style=cppstyle
%
% To produce a listing of code:
%   \begin{cpplisting}[option]
%   ...
%   \end{cpplisting}
% Uses \cppfgcolor, \cppbgcolor, style=cpplistingstyle, and style=cppstyle
%
%======================================================================


%----------------------------------------------------------------------
% Package identification:

\def\filedesc{C++ listings}
\def\filedate{2004/02/28}
\def\fileauth{W. E. Brown<wb at fnal dot gov>}


%----------------------------------------------------------------------
% Package boilerplate:

\NeedsTeXFormat{LaTeX2e}%
  [1995/12/01]

\ProvidesPackage{cpplistings}
  [\filedate\space\filedesc\space(\fileauth)]

% Exit if the style file is already loaded
\ifx \cpplistingsloaded\relax \endinput\else\let\cpplistingsloaded\relax\fi


%----------------------------------------------------------------------
% Prerequisite packages and initial configuration:

\RequirePackage{color}
\RequirePackage{colornames}

\RequirePackage{listings}
\lstloadlanguages{[ISO]C++}


%----------------------------------------------------------------------
% Color customization:

\newcommand{\cppbgcolor}%	applies to listings only
  {\color[gray]{.9}}

\newcommand{\cppfgcolor}%	applies to listings and inline snippets
  {\color{Navy}}


%----------------------------------------------------------------------
% Styles:

\lstdefinestyle{cpplistingstyle}%	applies to listings only
  { backgroundcolor	= \cppbgcolor
  , breaklines		= false
  , emptylines		= 1
  , escapeinside	= {(*@}{@*)}
  , frame		= none
  , framexleftmargin	= .35em
  , numberblanklines	= false
  , numbersep		= 10pt
  , numberstyle		= \tiny
  , numbers		= left
  , tabsize		= 2
  , xleftmargin		= 2em
  }

\lstdefinestyle{cppstyle}%	applies to listings and inline snippets
  { basicstyle		= \ttfamily\cppfgcolor
  , commentstyle	= \itshape\cppfgcolor
  , identifierstyle	= \cppfgcolor
  , keywordstyle	= %\bfseries\cppfgcolor
  , stringstyle		= \cppfgcolor
  }


%----------------------------------------------------------------------
% Language definition:

\lstdefinelanguage{isocpp}
  [ISO]{C++}
  { style = cppstyle }


%----------------------------------------------------------------------
% C++ code display:

\newcommand{\cppcode}[2][]%	inline snippets
  {\lstinline[language=isocpp,#1]{#2}}

\lstnewenvironment{cpplisting}[1][]%	listings
  { \lstset
      { language	= isocpp
      , style		= cpplistingstyle
      , #1
  }   }
  {}


%======================================================================
\endinput
